
<!-- saved from url=(0046)http://cowwu.myweb.hinet.net/note/js/Allot.htm -->
<HTML lang="zh-TW"><SCRIPT type="text/javascript">(function() {  function isText(node) {    return node.tagName == 'TEXTAREA' ||      node.tagName == 'INPUT' && node.type == 'text';  }  document.addEventListener('focus', function(event) {      if (isText(event.target))  {        event.target.setAttribute('littleurlfocussed', 'true');      }  }, true);  document.addEventListener('blur', function(event) {      if (isText(event.target)) {        event.target.removeAttribute('littleurlfocussed');      }  }, true);})();</SCRIPT><HEAD><META http-equiv="Content-Type" content="text/html; charset=Big5"><SCRIPT language="JavaScript" src="./totan_files/new-inner.js"></SCRIPT>


	
	<TITLE>自定籤筒抽籤</TITLE>
	<BODY STYLE=  "background:  #989898 url(http://philkuo.com/orang.99k.org/oranggameweb/bg.jpg) repeat-x" TOPMARGIN="0" LEFTMARGIN="0" MARGINWIDTH="0" MARGINHEIGHT="0"> 
	<link rel="shortcut icon" href="http://r1kpvq.bay.livefilestore.com/y1pzLjxumF2oTiycz8yNPfdYvQL72pE23ixaIMzg3rQhdRrGIALDPVjJiXYjXJezKGzOffkA0qkf1h3hpd6S_L-j37_HVKwQdB8/animated_favicon1.gif" type="image/x-icon" /> 
</HEAD><BODY>

<SCRIPT language="javascript">
function doAllot(f) {
	var entry = '\n';
	var ary = new Array();

	// 設定每支籤
	var lst = f.lst.value;
	var i = 0;
	while (lst.indexOf(entry)>0) {
		p = lst.indexOf(entry);
		ary[i++] = lst.substr(0, p);
		lst = lst.substr(p+1, lst.length);
	}
	ary[i] = lst;

	// 抽籤
	var result = '';
	var len = ary.length-1;
	var count = Math.min(Math.max(1, f.count.value), len);
	for(i=0; i<count; i++) {
		var choice = Math.round(Math.random()*len);
		result += (i+1) + ' ' + ary[choice] + entry;
		ary[choice] = ary[len];
		len--;
	}

	f.count.value  = count;
	f.result.value = result;
	return false;
}
</SCRIPT>
<NOSCRIPT></NOSCRIPT>

<FONT color="#EF0000">自定籤筒抽籤</FONT>
<FORM name="fm" onsubmit="return doAllot(document.fm)">
	要抽出的數量：<INPUT type="text" name="count" size="2" maxlength="2" value="3">

<BR>設定籤筒的內容：（換行表示為另一支籤）<BR>
<TEXTAREA name="lst" rows="9" cols="40">王昭君
西施
陳圓圓
楊玉環
趙飛燕</TEXTAREA>
	<BR>
	<INPUT type="Submit" value="Do!">
	<INPUT type="Reset" value="Reset">

	<BR><BR>結果：<BR>
	<TEXTAREA name="result" rows="9" cols="40"></TEXTAREA>
</FORM>


</BODY></HTML>