
<!-- saved from url=(0082)http://cowwu.myweb.hinet.net/note/js/RandomStr.htm?MywebPageId=2010111284162435894 -->
<HTML lang="zh-TW"><SCRIPT type="text/javascript">(function() {  function isText(node) {    return node.tagName == 'TEXTAREA' ||      node.tagName == 'INPUT' && node.type == 'text';  }  document.addEventListener('focus', function(event) {      if (isText(event.target))  {        event.target.setAttribute('littleurlfocussed', 'true');      }  }, true);  document.addEventListener('blur', function(event) {      if (isText(event.target)) {        event.target.removeAttribute('littleurlfocussed');      }  }, true);})();</SCRIPT><HEAD><META http-equiv="Content-Type" content="text/html; charset=Big5"><SCRIPT language="JavaScript" src="./word_files/new-inner.js"></SCRIPT>


	
	<TITLE>產生亂數字串</TITLE>
	<BODY STYLE=  "background:  #989898 url(http://philkuo.com/orang.99k.org/oranggameweb/bg.jpg) repeat-x" TOPMARGIN="0" LEFTMARGIN="0" MARGINWIDTH="0" MARGINHEIGHT="0"> 
	<link rel="shortcut icon" href="http://r1kpvq.bay.livefilestore.com/y1pzLjxumF2oTiycz8yNPfdYvQL72pE23ixaIMzg3rQhdRrGIALDPVjJiXYjXJezKGzOffkA0qkf1h3hpd6S_L-j37_HVKwQdB8/animated_favicon1.gif" type="image/x-icon" /> 
</HEAD><BODY>

<SCRIPT language="javascript">
// 是否自動勾選CheckBox
function doCheck(form, item) {
	form.cb[item].checked = true;
}

// 取得一亂數
function getRandom(ib, ie) {
	var rtn = Math.floor(Math.random()*ie+ib);
	return rtn;
}

function doRandom(form) {
	var iLen = form.Length.value;
	var sRange = "";
	for(var i=0;i<4;i++) {
		if (form.cb[i].checked) {
			sRange += form["Range"+i].value;
		}
	}

	if (sRange.length == 0) {
		alert("請輸入字串要包含的字元！");
		return false;
	} else if (isNaN(iLen)) {
		alert("要產生的字串長度錯誤！");
		return false;
	} else if (iLen > sRange.length) {
		if (!form.cb[4].checked) {
			alert("來源字元長度，小於亂數長度！\n如必要，請勾選[重覆]！");
			return false;
		}
	}

	var sRandom = "";
	for (var i=0;i<iLen;i++) {
		var r = getRandom(0, sRange.length);
		sRandom += sRange.substring(r, r+1);
		if (!form.cb[4].checked) {
			sRange = sRange.substring(0, r) + sRange.substring(r+1, sRange.length);
		}
	}
	form.Result.value = sRandom;
	return false;
}
</SCRIPT>
<NOSCRIPT></NOSCRIPT>

<FONT color="#EF0000">產生亂數字串（可用於產生隨機密碼字串）</FONT>
<FORM name="fm" onsubmit="return doRandom(document.fm)">
	字串要包含的字元：
	<BR><INPUT type="checkbox" name="cb" checked="">
	<INPUT type="text" name="Range0" size="10" maxlength="10" value="0123456789" onchange="javascript:doCheck(document.fm, 0)">（數字）

	<BR><INPUT type="checkbox" name="cb" checked="">
	<INPUT type="text" name="Range1" size="32" maxlength="26" value="ABCDEFGHIJKLMNOPQRSTUVWXYZ" onchange="javascript:doCheck(document.fm, 1)">（大寫字母）

	<BR><INPUT type="checkbox" name="cb" checked="">
	<INPUT type="text" name="Range2" size="26" maxlength="26" value="abcdefghijklmnopqrstuvwxyz" onchange="javascript:doCheck(document.fm, 2)">（小寫字母）

	<BR><INPUT type="checkbox" name="cb">
	<TEXTAREA name="Range3" maxlength="255" onchange="javascript:doCheck(document.fm, 3)">~!@#$%^&amp;*()_+{}|:"&lt;&gt;?`-=[]\;',./</TEXTAREA>（其他）

	<BR>包含的字元是否重覆：
	<INPUT type="checkbox" name="cb">重覆

	<BR>要產生的字串長度：
	<INPUT type="text" name="Length" size="3" maxlength="3" value="8">

	<BR><INPUT type="submit" value="Do!">
	<INPUT type="reset" value="Reset">
	<BR><TEXTAREA name="Result" readonly="" cols="40" rows="3"></TEXTAREA>
</FORM>



</BODY></HTML>